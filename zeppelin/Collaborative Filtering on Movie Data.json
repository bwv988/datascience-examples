{"paragraphs":[{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1484585580021_-1710510310","id":"20170116-165300_588663153","dateCreated":"2017-01-16T16:53:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:560","text":"%md \n\n## Example: Applied Collaborative Filtering for Recommendation Engines\n","dateUpdated":"2017-01-16T16:53:55+0000","dateFinished":"2017-01-16T16:53:55+0000","dateStarted":"2017-01-16T16:53:55+0000","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Example: Applied Collaborative Filtering for Recommendation Engines</h2>\n"}},{"text":"%sh\n\necho \"Downloading data to $(pwd)...\"\n\nexport DATA_URL_PREFIX=\"http://files.grouplens.org/datasets/movielens/\"\nexport SMALL_DATA=\"$DATA_URL_PREFIX/ml-latest-small.zip\"\n\ncurl -sSL $SMALL_DATA -o dataset.zip && \\\nunzip dataset.zip\n\n#hadoop fs -mkdir -p $HDFS_DATA_DIR\n#hadoop fs -copyFromLocal -f ml-20m/links.csv $HDFS_DATA_DIR/links.csv\n#hadoop fs -copyFromLocal -f ml-20m/movies.csv $HDFS_DATA_DIR/movies.csv\n#hadoop fs -copyFromLocal -f ml-20m/ratings.csv $HDFS_DATA_DIR/ratings.csv\n#hadoop fs -copyFromLocal -f ml-20m/tags.csv $HDFS_DATA_DIR/tags.csv\n\n# Clean up.\n\n#rm -r ml-20m\n#rm ml-20m.zip\n\necho -e \"\\n\\nDone. Files in HDFS:\"\n#hadoop fs -ls $HDFS_DATA_DIR","dateUpdated":"2017-01-16T18:08:36+0000","config":{"colWidth":12,"editorMode":"ace/mode/sh","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1484585572551_-1763236233","id":"20160905-173301_193364218","result":{"code":"SUCCESS","type":"TEXT","msg":"Downloading data to /workdir...\nArchive:  dataset.zip\n   creating: ml-latest-small/\n  inflating: ml-latest-small/links.csv  \n  inflating: ml-latest-small/movies.csv  \n  inflating: ml-latest-small/ratings.csv  \n  inflating: ml-latest-small/README.txt  \n  inflating: ml-latest-small/tags.csv  \n\n\nDone. Files in HDFS:\n"},"dateCreated":"2017-01-16T16:52:52+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:124","dateFinished":"2017-01-16T18:08:10+0000","dateStarted":"2017-01-16T18:08:08+0000","focus":true},{"text":"%pyspark\n\nfrom pyspark.sql.types import *\n\nratings_df_schema = StructType(\n  [StructField('userId', IntegerType()),\n   StructField('movieId', IntegerType()),\n   StructField('rating', DoubleType())]\n)\nmovies_df_schema = StructType(\n  [StructField('ID', IntegerType()),\n   StructField('title', StringType())]\n)","dateUpdated":"2017-01-16T16:52:52+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1484585572551_-1763236233","id":"20160905-175347_976876351","result":{"code":"SUCCESS","type":"TEXT","msg":""},"dateCreated":"2017-01-16T16:52:52+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:125"},{"text":"%pyspark\n\nhdfs_dir = '/user/zeppelin/ml-20m'\nratings_filename = hdfs_dir + '/ratings.csv'\nmovies_filename = hdfs_dir + '/movies.csv'","dateUpdated":"2017-01-16T16:52:52+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1484585572552_-1765159978","id":"20160905-180025_498313885","result":{"code":"SUCCESS","type":"TEXT","msg":""},"dateCreated":"2017-01-16T16:52:52+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:126"},{"text":"%pyspark\n\nfrom pyspark.sql.functions import regexp_extract\nfrom pyspark.sql.types import *\n\n\nraw_ratings_df = spark.read.schema(ratings_df_schema).option(\"header\", True).csv(ratings_filename)\nratings_df = raw_ratings_df.drop('Timestamp')\n\nraw_movies_df = spark.read.schema(movies_df_schema).option(\"header\", True).csv(movies_filename)\nmovies_df = raw_movies_df.drop('Genres').withColumnRenamed('movieId', 'ID')\n\nratings_df.cache()\nmovies_df.cache()\n\nassert ratings_df.is_cached\nassert movies_df.is_cached\n\nraw_ratings_count = raw_ratings_df.count()\nratings_count = ratings_df.count()\nraw_movies_count = raw_movies_df.count()\nmovies_count = movies_df.count()\n\nprint 'There are %s ratings and %s movies in the datasets' % (ratings_count, movies_count)\nprint 'Ratings:'\nratings_df.show(3)\nprint 'Movies:'\nmovies_df.show(3, truncate=False)","dateUpdated":"2017-01-16T16:52:52+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1484585572552_-1765159978","id":"20160905-181742_1291090020","result":{"code":"SUCCESS","type":"TEXT","msg":"There are 20000263 ratings and 27278 movies in the datasets\nRatings:\n+------+-------+------+\n|userId|movieId|rating|\n+------+-------+------+\n|     1|      2|   3.5|\n|     1|     29|   3.5|\n|     1|     32|   3.5|\n+------+-------+------+\nonly showing top 3 rows\n\nMovies:\n+---+-----------------------+\n|ID |title                  |\n+---+-----------------------+\n|1  |Toy Story (1995)       |\n|2  |Jumanji (1995)         |\n|3  |Grumpier Old Men (1995)|\n+---+-----------------------+\nonly showing top 3 rows\n\n"},"dateCreated":"2017-01-16T16:52:52+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:127"},{"text":"","dateUpdated":"2017-01-16T16:52:52+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1484585572552_-1765159978","id":"20160905-181811_1866959174","dateCreated":"2017-01-16T16:52:52+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:128"}],"name":"Collaborative Filtering on Movie Data","id":"2C7FTW4ST","angularObjects":{"2C7ZEW1B9:shared_process":[],"2C7GAM3TX:shared_process":[],"2C8XRXT3D:shared_process":[],"2C8B3QE11:shared_process":[],"2C841HNHN:shared_process":[],"2C637W9SU:shared_process":[],"2C6QP6K5P:shared_process":[],"2C953XXC8:shared_process":[],"2C5QRGX2Z:shared_process":[],"2C8HC545N:shared_process":[],"2C6SWKD5Q:shared_process":[],"2C6BM3HSJ:shared_process":[],"2C81JVBKQ:shared_process":[],"2C74HUE1N:shared_process":[],"2C6TPS6SD:shared_process":[],"2C9FDMPBZ:shared_process":[],"2C8N6KD49:shared_process":[],"2C8D1RM3G:shared_process":[]},"config":{"looknfeel":"default"},"info":{}}